{% extends "base.html" %}

{% block estilos %}
<link rel="stylesheet" href="{{ url_for('static', filename='listar.css') }}">
{% endblock %}

{% block conteudo %}
<div class="container">
    <h1>Itens Achados e Perdidos</h1>

    <div class="filtros">
        <a href="{{ url_for('item.listar') }}">Todos</a>
        <a href="{{ url_for('item.pendentes') }}">Pendentes</a>
        <a href="{{ url_for('item.encontrados') }}">Encontrados</a>
    </div>

    <a class="btn-add" href="{{ url_for('item.novo') }}">Cadastrar Novo Item</a>

    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Descrição</th>
                <th>Local</th>
                <th>Data Perdido</th>
                <th>Status</th>
                <th>Foto</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for i in itens %}
            <tr>
                <td>{{ i.nome }}</td>
                <td>{{ i.descricao or '-' }}</td>
                <td>{{ i.local }}</td>
                <td>{{ i.data.strftime("%d/%m/%Y") }}</td>
                <td>
                    {% if i.status == 'pendente' %}
                        <span class="status-pendente">Pendente</span>
                    {% else %}
                        <span class="status-encontrado">Encontrado</span>
                    {% endif %}
                </td>
                <td>
                    {% if i.foto %}
                        <img src="{{ url_for('static', filename='uploads/' ~ i.foto) }}" width="60">
                    {% else %}
                        Sem foto
                    {% endif %}
                </td>
                <td>
                    {% if i.status == 'pendente' %}
                        <a href="{{ url_for('item.marcar_encontrado', id=i.id) }}">Encontrado</a> |
                    {% else %}
                        <strong>Encontrado por:</strong><br>
                        {{ i.nome_encontrou }}<br>
                        {{ i.data_encontrado }}
                    {% endif %}
                    <a href="{{ url_for('item.editar', id=i.id) }}">Editar</a> |
                    <a href="{{ url_for('item.excluir', id=i.id) }}" onclick="return confirm('Tem certeza?');">Excluir</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" style="text-align:center;">Nenhum item encontrado</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
